# ==================== 应用配置 ====================
APP_NAME=RAG Knowledge Base Server
APP_VERSION=1.0.0
DEBUG=false
LOG_LEVEL=INFO

# ==================== 数据库配置 ====================
POSTGRES_USER=ragserver
POSTGRES_PASSWORD=ragserver_password
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=ragserver

# 数据库连接池配置
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ==================== Redis 配置 ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=ragserver_redis_password
REDIS_DB=0

# ==================== MinIO 对象存储配置 ====================
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=ragserver
MINIO_SECRET_KEY=ragserver_minio_password
MINIO_SECURE=false
MINIO_BUCKET_DOCUMENTS=documents
MINIO_BUCKET_AVATARS=avatars
MINIO_BUCKET_TEMP=temp

# ==================== JWT 认证配置 ====================
# 生产环境请使用强密钥！可以用 openssl rand -hex 32 生成
JWT_SECRET_KEY=your-secret-key-change-in-production-please-use-openssl-rand-hex-32
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# ==================== CORS 配置 ====================
# 开发环境可以使用 "*"，生产环境请指定具体域名
CORS_ORIGINS=*
CORS_ALLOW_CREDENTIALS=true

# ==================== 文件上传配置 ====================
MAX_FILE_SIZE_MB=100
ALLOWED_FILE_TYPES=pdf,docx,doc,txt,md,html,htm,xlsx,xls,csv,pptx,jpg,png

# ==================== Embedding 配置 ====================
# 默认使用本地模型 BAAI/bge-m3
DEFAULT_EMBEDDING_MODEL=BAAI/bge-m3
EMBEDDING_DIMENSION=1024
EMBEDDING_DEVICE=cuda

# 通义千问 API（可选，作为备选）
# QWEN_API_KEY=your-qwen-api-key-here
# QWEN_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
# QWEN_EMBEDDING_MODEL=text-embedding-v3
# QWEN_EMBEDDING_DIMENSION=1536

# OpenAI API（可选）
# OPENAI_API_KEY=your-openai-api-key
# OPENAI_API_BASE=https://api.openai.com/v1
# OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# ==================== LLM 配置 ====================
# 用于自然语言生成分块策略
DEFAULT_LLM_PROVIDER=qwen

# 通义千问 LLM
QWEN_LLM_MODEL=qwen-plus
QWEN_LLM_TEMPERATURE=0.7
QWEN_LLM_MAX_TOKENS=2000

# OpenAI LLM（可选）
# OPENAI_LLM_MODEL=gpt-4o-mini

# Anthropic Claude（可选）
# ANTHROPIC_API_KEY=your-anthropic-api-key
# ANTHROPIC_LLM_MODEL=claude-3-5-sonnet-20241022

# ==================== 向量搜索配置 ====================
# 向量索引类型: hnsw 或 ivfflat
VECTOR_INDEX_TYPE=hnsw
HNSW_M=16
HNSW_EF_CONSTRUCTION=64
IVFFLAT_LISTS=100

# 搜索默认配置
DEFAULT_SEARCH_TYPE=hybrid
DEFAULT_TOP_K=10
DEFAULT_SIMILARITY_THRESHOLD=0.7

# 混合搜索权重
HYBRID_VECTOR_WEIGHT=0.7
HYBRID_FULLTEXT_WEIGHT=0.3

# ==================== 缓存配置 ====================
CACHE_ENABLED=true
CACHE_TTL_SECONDS=300
QUERY_VECTOR_CACHE_TTL=86400
SEARCH_RESULT_CACHE_TTL=300

# ==================== 限流配置 ====================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_DAILY_QUOTA=10000

# ==================== 任务队列配置 ====================
TASKIQ_WORKERS=4
TASKIQ_WORKERS_DOCUMENT=2
TASKIQ_WORKERS_EMBEDDING=2
TASKIQ_MAX_RETRIES=3
TASKIQ_RETRY_DELAY=60

# 文档处理配置
DOCUMENT_PROCESSING_TIMEOUT=600
EMBEDDING_BATCH_SIZE=50
EMBEDDING_MAX_CONCURRENCY=3

# ==================== 监控配置 ====================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# ==================== 日志配置 ====================
LOG_FILE_ENABLED=true
LOG_FILE_PATH=logs/app.log
LOG_FILE_MAX_SIZE=10485760
LOG_FILE_BACKUP_COUNT=10

# ==================== 安全配置 ====================
# 密码策略
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=false

# API Key 配置
API_KEY_PREFIX=kb_
API_KEY_LENGTH=32

# ==================== 存储配额配置 ====================
DEFAULT_USER_STORAGE_QUOTA_GB=10
MAX_KNOWLEDGE_BASES_PER_USER=100
MAX_DOCUMENTS_PER_KNOWLEDGE_BASE=10000

# ==================== OCR 配置 ====================
OCR_ENABLED=true
OCR_AUTO_DETECT_THRESHOLD=50
OCR_LANGUAGES=zh,en

# ==================== Webhook 配置 ====================
WEBHOOK_ENABLED=true
WEBHOOK_TIMEOUT=10
WEBHOOK_MAX_RETRIES=3

# ==================== 开发模式配置 ====================
RELOAD=false
DOCS_URL=/docs
REDOC_URL=/redoc
OPENAPI_URL=/openapi.json

# ==================== PM2 配置 ====================
API_PORT=8000

